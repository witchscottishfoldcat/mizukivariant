const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["_astro/translation.BEYOwJ1L.js","_astro/config.BNwZDY95.js","_astro/zh_TW.ORda0UXz.js"])))=>i.map(i=>d[i]);
import{_ as ge}from"./preload-helper.BlTxHScW.js";import{s as me}from"./lifecycle.DavBjZBb.js";import{x as _e,y as fe,z as Be,g as m,A as Se,h as A,d as xe,e as M,t as he,o as Z,a as Ce,p as ke,b as ve,s as Ee,B as pe,r as S}from"./utils.DJr-jBEw.js";import{s as De}from"./render.DfBNuYju.js";import{e as ze,i as ye}from"./each.CrZuCW-W.js";import"./config.BNwZDY95.js";import"./zh_TW.ORda0UXz.js";import{I as we}from"./Icon.3ByRVZCK.js";import"./if.C1JizXau.js";import"./props.C0ApMCPi.js";function Me($,_){A(_,!m(_))}var Le=($,_,j)=>_(m(j).code),We=xe("<button><!> <span> </span></button>"),qe=xe('<div class="language-switch-container relative z-50"><button aria-label="Language Switch" class="relative btn-plain scale-animation rounded-lg h-11 w-11 active:scale-90" id="language-switch"><div class="flex items-center justify-center"><!></div></button> <div role="menu" tabindex="-1"></div></div>');function Ie($,_){ve(_,!0);const j=[{code:"en",name:"English"},{code:"zh_CN",name:"简体中文"}];function Fe(){if(typeof window<"u"&&window.__currentLanguage)return console.log("LanguageSwitch: 使用全局变量语言",window.__currentLanguage),window.__currentLanguage;const o=localStorage.getItem("language")||"en";return console.log("LanguageSwitch: 使用localStorage语言",o),o}let w=fe(Be(Fe())),x=fe(!1);function k(){if(typeof window>"u")return!1;const o=window.location.pathname;return o==="/"||o===""||o==="/index.html"}function F(o=!1){const s=document.cookie.split(";").find(l=>l.trim().startsWith("language="))?.split("=")[1]?.trim(),n=localStorage.getItem("language"),u=s||n||"en";if(u!==m(w)||o){if(console.log("LanguageSwitch: 从存储同步语言",u,"当前语言",m(w),"强制更新",o),A(w,u,!0),typeof window<"u"&&(window.__currentLanguage=u),document.documentElement.lang=u,s&&s!==n&&localStorage.setItem("language",s),n&&n!==s){const l=`language=${n}; path=/; max-age=31536000; SameSite=Lax`;document.cookie=l}K(),T()}}function v(o=3,s=200){const n=m(w),u=k(),l=u?1:o,d=u?300:s;console.log(`LanguageSwitch: 强制更新页面文本，语言: ${n}, 剩余重试: ${l}, 首页: ${u}`),F(),T(),l>0&&setTimeout(()=>{v(l-1,d)},d)}function I(){if(typeof window<"u"&&window.swup){const o=window.swup;o.hooks.on("content:replace",()=>{console.log("LanguageSwitch: Swup content:replace 事件"),setTimeout(()=>{F()},50)}),o.hooks.on("page:view",()=>{console.log("LanguageSwitch: Swup page:view 事件"),k()?setTimeout(()=>{F(),T()},200):setTimeout(()=>{v(3,200)},150)}),o.hooks.on("animation:in:end",()=>{console.log("LanguageSwitch: Swup animation:in:end 事件"),k()?setTimeout(()=>{F(),T()},150):setTimeout(()=>{v(3,200)},100)}),console.log("LanguageSwitch: Swup 监听器已注册")}else setTimeout(()=>{I()},200)}if(typeof window<"u"){if(F(),setTimeout(I,100),window.addEventListener("popstate",()=>{k()?setTimeout(()=>{F(),T()},200):setTimeout(()=>{v(3,200)},150)}),typeof MutationObserver<"u"){let o=null;const s=new MutationObserver(u=>{let l=!1;u.forEach(d=>{d.type==="childList"&&d.addedNodes.length>0&&d.addedNodes.forEach(f=>{if(f.nodeType===1){const c=f;(c.tagName==="MAIN"||c.tagName==="ARTICLE"||c.querySelector?.("main")||c.querySelector?.("article")||c.querySelector?.("[data-i18n]")||c.hasAttribute?.("data-i18n"))&&(l=!0)}})}),l&&(o&&clearTimeout(o),o=setTimeout(()=>{const d=k();console.log("LanguageSwitch: DOM 内容变化，更新语言，首页:",d),d?(F(),T()):v(2,150)},200))}),n=document.body;n&&(s.observe(n,{childList:!0,subtree:!0}),console.log("LanguageSwitch: MutationObserver 已设置，观察 body 变化")),window.swup&&window.swup.hooks.on("content:replace",()=>{setTimeout(()=>{const l=document.querySelector("main");if(l&&!l.isConnected){const d=document.querySelector("main");d&&(s.observe(d,{childList:!0,subtree:!0}),console.log("LanguageSwitch: 重新设置 MutationObserver"))}},50)})}window.addEventListener("language-changed",()=>{F()}),setInterval(()=>{F()},5e3)}function be(o){console.log("LanguageSwitch: 切换语言到",o),A(w,o,!0),localStorage.setItem("language",o),console.log("LanguageSwitch: 已设置localStorage",localStorage.getItem("language")),typeof window<"u"&&(window.__currentLanguage=o,console.log("LanguageSwitch: 已设置全局变量",window.__currentLanguage));const s=`language=${o}; path=/; max-age=${3600*24*365}; SameSite=Lax`;document.cookie=s,console.log("LanguageSwitch: 已设置Cookie",s),console.log("LanguageSwitch: 当前所有Cookie",document.cookie);const n=()=>{const u=document.cookie.split(";").find(l=>l.trim().startsWith("language="))?.split("=")[1]?.trim();return!u||u!==o?(console.warn("LanguageSwitch: Cookie验证失败，重试设置","期望:",o,"实际:",u),document.cookie=s,!1):!0};n(),setTimeout(()=>{n()||setTimeout(n,100)},50),document.documentElement.lang=o,console.log("LanguageSwitch: 已设置HTML lang属性",document.documentElement.lang),typeof window<"u"&&(window.dispatchEvent(new CustomEvent("language-changed",{detail:{lang:o}})),console.log("LanguageSwitch: 已触发 language-changed 事件")),K(),T(),console.log("LanguageSwitch: 语言切换完成，已更新所有文本（不刷新页面）")}function T(){const o=m(w);console.log("LanguageSwitch: 更新页面文本，语言:",o),ge(async()=>{const{getTranslation:s}=await import("./translation.BEYOwJ1L.js");return{getTranslation:s}},__vite__mapDeps([0,1,2])).then(({getTranslation:s})=>{ge(async()=>{const{default:n}=await import("./zh_TW.ORda0UXz.js").then(u=>u.i);return{default:n}},[]).then(({default:n})=>{const u=s(o);document.querySelectorAll("[data-i18n]").forEach(e=>{const t=e.getAttribute("data-i18n");t&&u[t]&&(e.textContent=u[t])});const d=document.querySelector('widget-layout[data-id="categories"]');if(d){const e=d.querySelector(".font-bold");e&&u[n.categories]&&(e.textContent=u[n.categories])}const f=document.querySelector('widget-layout[data-id="tags"]');if(f){const e=f.querySelector(".font-bold");e&&u[n.tags]&&(e.textContent=u[n.tags])}const c=document.querySelector('widget-layout[data-id="announcement"]');if(c){const e=c.querySelector(".font-bold");e&&u[n.announcement]&&(e.textContent=u[n.announcement]);const t=c.querySelector("button[aria-label]");t&&u[n.announcementClose]&&t.setAttribute("aria-label",u[n.announcementClose]);const a={"Welcome to my blog! This is a sample announcement.":{en:"Welcome to my blog! This is a sample announcement.",zh_CN:"欢迎来到我的博客！这是一个示例公告。"}},i={};Object.values(a).forEach(g=>{i[g.zh_CN]=g.en});const r=c.querySelector(".text-neutral-600, .text-neutral-300");if(r){const g=r.textContent?.trim()||"";let E=null;a[g]?E=a[g][o]||a[g].en:o==="en"&&i[g]&&(E=i[g]),E&&E!==g&&(r.textContent=E)}const h={"Learn More":{en:"Learn More",zh_CN:"了解更多"}},p={};Object.values(h).forEach(g=>{p[g.zh_CN]=g.en});const b=c.querySelector("a.btn-regular");if(b){const g=b.textContent?.trim()||"";let E=null;h[g]?E=h[g][o]||h[g].en:o==="en"&&p[g]&&(E=p[g]),E&&E!==g&&(b.textContent=E)}}document.querySelectorAll(".expand-btn button").forEach(e=>{const t=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null);let a=t.nextNode();for(;a!==null;){const i=a.textContent?.trim();if(i&&(i.toLowerCase().includes("more")||i==="更多"||i===u[n.more]||["More","更多","もっと","Más","Mehr"].some(r=>i===r))&&u[n.more]){a.textContent=u[n.more];break}a=t.nextNode()}}),document.querySelectorAll("widget-layout").forEach(e=>{const t=e.querySelector(".font-bold");if(t){const a=e.getAttribute("data-id");a==="categories"&&u[n.categories]?t.textContent=u[n.categories]:a==="tags"&&u[n.tags]?t.textContent=u[n.tags]:a==="announcement"&&u[n.announcement]&&(t.textContent=u[n.announcement])}}),document.querySelectorAll(".text-50, .text-75, .text-90, .text-sm").forEach(e=>{const t=e.textContent||"",a=t.match(/(\d+)\s+(word|words|字)\b/i);if(a){const i=Number.parseInt(a[1],10),r=i>1?u[n.wordsCount]:u[n.wordCount];if(r){const h=t.replace(/(\d+)\s+(word|words|字)\b/gi,`${i} ${r}`);if(h!==t)if(e.childNodes.length===1&&e.firstChild?.nodeType===Node.TEXT_NODE)e.textContent=h;else{const p=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null);let b=p.nextNode();for(;b!==null;){const g=b.textContent||"";if(g.match(/(\d+)\s+(word|words|字)\b/i)){const E=g.match(/(\d+)\s+(word|words|字)\b/i);if(E){const ce=Number.parseInt(E[1],10),de=ce>1?u[n.wordsCount]:u[n.wordCount];de&&(b.textContent=g.replace(/(\d+)\s+(word|words|字)\b/gi,`${ce} ${de}`))}break}b=p.nextNode()}}}}}),document.querySelectorAll(".text-50, .text-75, .text-90").forEach(e=>{const t=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null);let a=t.nextNode();for(;a!==null;){const i=a.textContent?.trim();(i==="Uncategorized"||i==="未分类")&&u[n.uncategorized]&&(a.textContent=u[n.uncategorized]),a=t.nextNode()}}),document.querySelectorAll(".text-50, .text-75").forEach(e=>{const t=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null);let a=t.nextNode();for(;a!==null;){const i=a.textContent?.trim();(i==="No Tags"||i==="无标签")&&u[n.noTags]&&(a.textContent=u[n.noTags]),a=t.nextNode()}});const Ae={"Previous Page":o==="zh_CN"?"上一页":"Previous Page","Next Page":o==="zh_CN"?"下一页":"Next Page","Go to About Page":o==="zh_CN"?"前往关于页面":"Go to About Page","Display Settings":o==="zh_CN"?"显示设置":"Display Settings",Menu:o==="zh_CN"?"菜单":"Menu","Back to Top":o==="zh_CN"?"返回顶部":"Back to Top","Search Panel":o==="zh_CN"?"搜索面板":"Search Panel","Table of Contents":u[n.tableOfContents]||"Table of Contents","Close TOC":o==="zh_CN"?"关闭目录":"Close TOC"};document.querySelectorAll("[aria-label]").forEach(e=>{const t=e.getAttribute("aria-label");if(t){for(const[i,r]of Object.entries(Ae))if(t===i){e.setAttribute("aria-label",r);break}const a=t.match(/^Page (\d+)$/);a&&o==="zh_CN"&&e.setAttribute("aria-label",`第 ${a[1]} 页`)}}),document.querySelectorAll("input[placeholder], textarea[placeholder]").forEach(e=>{const t=e.placeholder;t&&t==="Search"&&u[n.search]&&(e.placeholder=u[n.search])});const ne=document.querySelector(".card-base");if(ne){const e=document.createTreeWalker(ne,NodeFilter.SHOW_TEXT,null);let t=e.nextNode();for(;t!==null;){const a=t.textContent||"",i=a.match(/(\d+)\s+(post|posts|篇文章)\b/i);if(i){const r=Number.parseInt(i[1],10),h=r>1?u[n.postsCount]:u[n.postCount];h&&(t.textContent=a.replace(/(\d+)\s+(post|posts|篇文章)\b/gi,`${r} ${h}`))}t=e.nextNode()}}const L={"Markdown Tutorial":{en:"Markdown Tutorial",zh_CN:"Markdown 教程"},"Encrypted Post":{en:"Encrypted Post",zh_CN:"加密文章"},"Markdown Extended Features":{en:"Markdown Extended Features",zh_CN:"Markdown 扩展功能"},"Simple Guides for Mizuki":{en:"Simple Guides for Mizuki",zh_CN:"Mizuki 简单指南"},"Cover Image of the Post":{en:"Cover Image of the Post",zh_CN:"文章封面图片"},"Markdown Mermaid":{en:"Markdown Mermaid",zh_CN:"Markdown Mermaid"},"Include Video in the Posts":{en:"Include Video in the Posts",zh_CN:"在文章中嵌入视频"},"Draft Example":{en:"Draft Example",zh_CN:"草稿示例"}},G={};Object.values(L).forEach(e=>{G[e.zh_CN]=e.en});function oe(e,t){if(L[e])return L[e][t]||null;if(t==="en"&&G[e])return G[e];if(t==="en"){for(const[a,i]of Object.entries(L))if(i.zh_CN===e)return a}return null}const W={"A simple example of a Markdown blog post.":{en:"A simple example of a Markdown blog post.",zh_CN:"一个简单的 Markdown 博客文章示例。"},"A simple example of a Markdown blog post with Mermaid.":{en:"A simple example of a Markdown blog post with Mermaid.",zh_CN:"一个包含 Mermaid 图表的 Markdown 博客文章示例。"},"Read more about Markdown features in Mizuki":{en:"Read more about Markdown features in Mizuki",zh_CN:"了解更多关于 Mizuki 中的 Markdown 功能"},"This is an article for testing the page encryption feature":{en:"This is an article for testing the page encryption feature",zh_CN:"这是一篇用于测试页面加密功能的文章"},"This post demonstrates how to include embedded video in a blog post.":{en:"This post demonstrates how to include embedded video in a blog post.",zh_CN:"这篇文章演示了如何在博客文章中嵌入视频。"},"This article is currently in a draft state and is not published. Therefore, it will not be visible to the general audience. The content is still a work in progress and may require further editing and review.":{en:"This article is currently in a draft state and is not published. Therefore, it will not be visible to the general audience. The content is still a work in progress and may require further editing and review.",zh_CN:"这篇文章目前处于草稿状态，尚未发布。因此，它不会对普通观众可见。内容仍在进行中，可能需要进一步编辑和审查。"},"How to use this blog template.":{en:"How to use this blog template.",zh_CN:"如何使用这个博客模板。"}},V={};Object.values(W).forEach(e=>{V[e.zh_CN]=e.en});function ue(e,t){if(W[e])return W[e][t]||null;if(t==="en"&&V[e])return V[e];if(t==="en"){for(const[a,i]of Object.entries(W))if(i.zh_CN===e)return a}return null}[".card-base a.text-3xl",".card-base .text-3xl","h1",".text-\\[2\\.25rem\\]","[data-pagefind-meta='title']"].forEach(e=>{try{document.querySelectorAll(e).forEach(a=>{const i=a.textContent?.trim()||"";if(i){const r=oe(i,o);r&&r!==i&&(a.textContent=r)}})}catch(t){console.warn("LanguageSwitch: 标题选择器错误",e,t)}});const ae=document.createTreeWalker(document.body,NodeFilter.SHOW_TEXT,null);let q=ae.nextNode();for(;q!==null;){const e=q.textContent?.trim()||"";if(e){const t=oe(e,o);t&&t!==e&&(q.textContent=t)}q=ae.nextNode()}[".card-base .text-75",".line-clamp-2",".line-clamp-1"].forEach(e=>{try{document.querySelectorAll(e).forEach(a=>{const i=a.textContent?.trim()||"";if(i){const r=ue(i,o);r&&r!==i&&(a.textContent=r)}})}catch(t){console.warn("LanguageSwitch: 描述选择器错误",e,t)}});const ie=document.createTreeWalker(document.body,NodeFilter.SHOW_TEXT,null);let O=ie.nextNode();for(;O!==null;){const e=O.textContent?.trim()||"";if(e){const t=ue(e,o);t&&t!==e&&(O.textContent=t)}O=ie.nextNode()}const U={Search:n.search,Categories:n.categories,Tags:n.tags,Announcement:n.announcement,More:n.more,Home:n.home,About:n.about,Archive:n.archive,Friends:n.friends,Anime:n.anime,Diary:n.diary,Albums:n.albums,Projects:n.projects,Skills:n.skills,Timeline:n.timeline},J={};Object.entries(U).forEach(([e,t])=>{const a=u[t];a&&(J[a]=e)});const y={Examples:{en:"Examples",zh_CN:"示例"},Guides:{en:"Guides",zh_CN:"指南"},Technology:{en:"Technology",zh_CN:"技术"}},Q={};Object.values(y).forEach(e=>{Q[e.zh_CN]=e.en});function Y(e,t){if(y[e])return y[e][t]||null;if(t==="en"&&Q[e])return Q[e];if(t==="en"){for(const[a,i]of Object.entries(y))if(i.zh_CN===e)return a}return null}const re=document.querySelector('widget-layout[data-id="categories"]');re&&re.querySelectorAll("a button").forEach(t=>{const a=t.querySelector("div.overflow-hidden.text-left");if(a){const i=a.textContent?.trim()||"";if(i){const r=Y(i,o);if(r&&r!==i){const h=document.createTreeWalker(a,NodeFilter.SHOW_TEXT,null);let p=h.nextNode();for(;p!==null;){if(p.textContent?.trim()===i){p.textContent=r;break}p=h.nextNode()}}}}}),[".link-lg",".text-50"].forEach(e=>{try{document.querySelectorAll(e).forEach(a=>{const i=a.textContent?.trim()||"";if(i){const r=Y(i,o);r&&r!==i&&(a.textContent=r)}})}catch(t){console.warn("LanguageSwitch: 分类选择器错误",e,t)}});const se=document.createTreeWalker(document.body,NodeFilter.SHOW_TEXT,null);let P=se.nextNode();for(;P!==null;){const e=P.textContent?.trim()||"";if(e){let t=Y(e,o);if(!t){for(const[a,i]of Object.entries(y))if(e.startsWith(a)||e.startsWith(i.zh_CN)){const r=e.match(/\s+(\d+)$/),h=r?r[0]:"";o==="zh_CN"?t=i.zh_CN+h:t=i.en+h;break}}t&&t!==e&&(P.textContent=t)}P=se.nextNode()}const le=document.createTreeWalker(document.body,NodeFilter.SHOW_TEXT,null);let H=le.nextNode();for(;H!==null;){const e=H.textContent?.trim()||"";if(e){let t=null;if(U[e]){const a=U[e];t=u[a]}else o==="en"&&J[e]&&(t=J[e]);t&&t!==e&&(H.textContent=t)}H=le.nextNode()}console.log("LanguageSwitch: 页面文本更新完成")})}).catch(s=>{console.error("LanguageSwitch: 无法加载翻译模块",s)})}function K(){const o=m(w);console.log("LanguageSwitch: 更新导航栏文本，语言:",o);const s={Home:{en:"Home",zh_CN:"主页"},About:{en:"About",zh_CN:"关于"},Archive:{en:"Archive",zh_CN:"归档"},Friends:{en:"Friends",zh_CN:"友链"},Anime:{en:"Anime",zh_CN:"追番"},Diary:{en:"Diary",zh_CN:"日记"},Albums:{en:"Albums",zh_CN:"相册"},Projects:{en:"Projects",zh_CN:"项目"},Skills:{en:"Skills",zh_CN:"技能"},Timeline:{en:"Timeline",zh_CN:"时间线"}},n=(u,l,d,f)=>{const c=document.createTreeWalker(u,NodeFilter.SHOW_TEXT,null);let B=c.nextNode();for(;B!==null;){const N=B.textContent?.trim();if(N===l||N===d)return B.textContent=f,!0;B=c.nextNode()}const X=u.querySelectorAll("span");for(const N of X){const C=N.textContent?.trim();if(C===l||C===d)return N.textContent=f,!0}return!1};for(const[u,l]of Object.entries(s)){const d=l[o]||l.en,f=l.en,c=l.zh_CN;document.querySelectorAll("#navbar button, #navbar a").forEach(C=>{(C.textContent?.trim().includes(f)||C.textContent?.trim().includes(c))&&n(C,f,c,d)}),document.querySelectorAll("#nav-menu-panel button, #nav-menu-panel a").forEach(C=>{(C.textContent?.trim().includes(f)||C.textContent?.trim().includes(c))&&n(C,f,c,d)}),document.querySelectorAll(".dropdown-item").forEach(C=>{(C.textContent?.trim().includes(f)||C.textContent?.trim().includes(c))&&n(C,f,c,d)})}console.log("LanguageSwitch: 导航栏文本更新完成")}function Te(){switch(m(w)){case"en":return"circle-flags:us";case"zh_CN":return"circle-flags:cn";default:return"circle-flags:us"}}typeof window<"u"&&Se(()=>{document.documentElement.lang=m(w)}),typeof document<"u"&&document.addEventListener("click",o=>{o.target.closest(".language-switch-container")||A(x,!1)});var R=qe(),D=M(R);D.__click=[Me,x];var ee=M(D),Ne=M(ee);{let o=pe(Te);we(Ne,{get icon(){return m(o)},class:"text-[1.25rem]"})}S(ee),S(D);var z=Ee(D,2);let te;ze(z,21,()=>j,ye,(o,s)=>{var n=We();let u;n.__click=[Le,be,s];var l=M(n);{let c=pe(()=>m(s).code==="en"?"circle-flags:us":"circle-flags:cn");we(l,{get icon(){return m(c)},class:"text-[1rem]"})}var d=Ee(l,2),f=M(d,!0);S(d),S(n),he(c=>{u=me(n,1,"w-full text-left px-4 py-2 text-sm hover:bg-[var(--hover-bg)] first:rounded-t-lg last:rounded-b-lg flex items-center gap-2",null,u,c),De(f,m(s).name)},[()=>({"bg-[var(--hover-bg)]":m(w)===m(s).code})]),Ce(o,n)}),S(z),S(R),he(o=>te=me(z,1,"absolute right-0 mt-2 w-40 rounded-lg shadow-lg bg-[var(--card-bg)] border border-[var(--border-color)] transition-all duration-200 z-50",null,te,o),[()=>({"opacity-0":!m(x),invisible:!m(x),"opacity-100":m(x),visible:m(x)})]),Z("mouseenter",D,()=>A(x,!0)),Z("mouseleave",z,()=>A(x,!1)),Z("mouseenter",z,()=>A(x,!0)),Ce($,R),ke()}_e(["click"]);export{Ie as default};
