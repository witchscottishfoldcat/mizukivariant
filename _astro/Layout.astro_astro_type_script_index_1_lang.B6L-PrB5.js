import{B as S,b as L,c as A}from"./constants.CzT201-o.js";import{p as D,u as H}from"./url-utils.DfOERwCx.js";import{s as b}from"./config.BNwZDY95.js";import{I as g}from"./zh_TW.Jbo5k0IW.js";import{g as C}from"./translation.HLRjpXWO.js";function M(){let t="en";return typeof window<"u"&&(window.__currentLanguage?(t=window.__currentLanguage,console.log("Debug i18n: 全局变量语言",t)):(t=localStorage.getItem("language")||"en",console.log("Debug i18n: localStorage语言",t))),[g.search,g.home,g.about,g.archive].forEach(e=>{const n=C(t)[e];console.log(`Debug i18n: ${e} -> ${n}`)}),t}const I=!!document.getElementById("banner-wrapper");function k(t,o){document.addEventListener("click",e=>{let n=document.getElementById(t),a=e.target;if(a instanceof Node){for(let s of o){let c=document.getElementById(s);if(c==a||c?.contains(a))return}n.classList.add("float-panel-closed")}})}k("display-setting",["display-setting","display-settings-switch"]);k("nav-menu-panel",["nav-menu-panel","nav-menu-switch"]);k("search-panel",["search-panel","search-bar","search-switch"]);function q(){document.querySelectorAll(".katex-display:not([data-scrollbar-initialized])").forEach(o=>{if(!o.parentNode)return;const e=document.createElement("div");e.className="katex-display-container",o.parentNode.insertBefore(e,o),e.appendChild(o),e.style.cssText=`
			overflow-x: auto;
			scrollbar-width: thin;
			scrollbar-color: rgba(0,0,0,0.3) transparent;
		`;const n=document.createElement("style");n.textContent=`
			.katex-display-container::-webkit-scrollbar {
				height: 6px;
			}
			.katex-display-container::-webkit-scrollbar-track {
				background: transparent;
			}
			.katex-display-container::-webkit-scrollbar-thumb {
				background: rgba(0,0,0,0.3);
				border-radius: 3px;
			}
			.katex-display-container::-webkit-scrollbar-thumb:hover {
				background: rgba(0,0,0,0.5);
			}
		`,document.head.querySelector("style[data-katex-scrollbar]")||(n.setAttribute("data-katex-scrollbar","true"),document.head.appendChild(n)),o.setAttribute("data-scrollbar-initialized","true")})}function x(){b.banner.enable&&requestAnimationFrame(()=>{const t=document.getElementById("banner");t&&t.classList.remove("opacity-0","scale-105");const o=document.querySelector('.block.lg\\:hidden[alt="Mobile banner image of the blog"]');o&&!document.getElementById("banner-carousel")&&(o.classList.remove("opacity-0","scale-105"),o.classList.add("opacity-100")),document.getElementById("banner-carousel")&&_()})}function _(){const t=document.querySelectorAll(".carousel-item"),o=window.innerWidth<1024,e=Array.from(t).filter(n=>o?n.querySelector(".block.lg\\:hidden"):n.querySelector(".hidden.lg\\:block"));if(e.length>1&&!b.banner.carousel?.enable){t.forEach((s,c)=>{s.classList.add("opacity-0","scale-110"),s.classList.remove("opacity-100","scale-100")});const n=Math.floor(Math.random()*e.length),a=e[n];a.classList.add("opacity-100","scale-100"),a.classList.remove("opacity-0","scale-110");return}if(e.length>1&&b.banner.carousel?.enable){let n=function(i){const m=e[s];m.classList.remove("opacity-100","scale-100"),m.classList.add("opacity-0","scale-110"),s=i;const h=e[s];h.classList.add("opacity-100","scale-100"),h.classList.remove("opacity-0","scale-110")},a=function(){clearInterval(r),r=setInterval(()=>{if(!l){const i=(s+1)%e.length;n(i)}},c*1e3)},s=0;const c=b.banner.carousel?.interval||6;let r,l=!1,d=0,p=0,f=!1;const u=document.getElementById("banner-carousel");t.forEach(i=>{i.classList.add("opacity-0","scale-110"),i.classList.remove("opacity-100","scale-100")}),e.length>0&&(e[0].classList.add("opacity-100","scale-100"),e[0].classList.remove("opacity-0","scale-110")),u&&"ontouchstart"in window&&(u.addEventListener("touchstart",i=>{d=i.touches[0].clientX,p=i.touches[0].clientY,f=!1,l=!0,clearInterval(r)},{passive:!0}),u.addEventListener("touchmove",i=>{if(!d||!p)return;const m=Math.abs(i.touches[0].clientX-d),h=Math.abs(i.touches[0].clientY-p);m>h&&m>30&&(f=!0,i.preventDefault())},{passive:!1}),u.addEventListener("touchend",i=>{if(!d||!p||!f){l=!1,a();return}const m=i.changedTouches[0].clientX,h=d-m;if(Math.abs(h)>50)if(h>0){const w=(s+1)%e.length;n(w)}else{const w=(s-1+e.length)%e.length;n(w)}d=0,p=0,f=!1,l=!1,a()},{passive:!0})),u&&(u.addEventListener("mouseenter",()=>{l=!0,clearInterval(r)}),u.addEventListener("mouseleave",()=>{l=!1,a()})),a()}}const T=()=>{window.swup.hooks.on("link:click",()=>{if(document.documentElement.style.setProperty("--content-delay","0ms"),I){const t=document.getElementById("navbar-wrapper");if(t&&document.body.classList.contains("lg:is-home")){const o=window.innerHeight*(L/100)-88;document.documentElement.scrollTop>=o&&t.classList.add("navbar-hidden")}}}),window.swup.hooks.on("content:replace",()=>{if(q(),document.getElementById("toc-wrapper")!==null){const n=document.querySelector("table-of-contents");n&&typeof n.init=="function"&&setTimeout(()=>{n.init()},100),typeof window.mobileTOCInit=="function"&&setTimeout(()=>{window.mobileTOCInit()},100)}const e=document.getElementById("navbar");e&&e.getAttribute("data-transparent-mode")==="semifull"&&typeof window.initSemifullScrollDetection=="function"&&window.initSemifullScrollDetection()}),window.swup.hooks.on("visit:start",t=>{const o=document.querySelector("body"),e=D(t.to.url,H("/"));e?o.classList.add("lg:is-home"):o.classList.remove("lg:is-home");const n=document.querySelector(".banner-text-overlay");n&&(e?n.classList.remove("hidden"):n.classList.add("hidden"));const a=document.getElementById("navbar");a&&(a.setAttribute("data-is-home",e.toString()),a.getAttribute("data-transparent-mode")==="semifull"&&typeof window.initSemifullScrollDetection=="function"&&window.initSemifullScrollDetection());const s=document.getElementById("banner-wrapper"),c=document.querySelector(".absolute.w-full.z-30");s&&c&&(e?(setTimeout(()=>{s.classList.remove("mobile-hide-banner")},100),setTimeout(()=>{c.classList.remove("mobile-main-no-banner")},150)):(s.classList.add("mobile-hide-banner"),setTimeout(()=>{c.classList.add("mobile-main-no-banner")},100)));const r=document.getElementById("page-height-extend");r&&r.classList.remove("hidden");let l=document.getElementById("toc-wrapper");l&&l.classList.add("toc-not-ready")}),window.swup.hooks.on("page:view",()=>{const t=document.getElementById("page-height-extend");t&&t.classList.remove("hidden"),window.scrollTo({top:0,behavior:"instant"});const n=(localStorage.getItem("theme")||"LIGHT_MODE")==="DARK_MODE"?"github-dark":"github-light";document.documentElement.getAttribute("data-theme")!==n&&(document.documentElement.setAttribute("data-theme",n),setTimeout(()=>{window.dispatchEvent(new CustomEvent("theme-change"))},50)),setTimeout(()=>{if(document.getElementById("tcomment")){const s=new CustomEvent("mizuki:page:loaded",{detail:{path:window.location.pathname,timestamp:Date.now()}});document.dispatchEvent(s),console.log("Layout: 触发 mizuki:page:loaded 事件，路径:",window.location.pathname)}},300)}),window.swup.hooks.on("visit:end",t=>{setTimeout(()=>{const o=document.getElementById("page-height-extend");o&&o.classList.add("hidden");const e=document.getElementById("toc-wrapper");e&&e.classList.remove("toc-not-ready")},200)})};window?.swup?.hooks?T():document.addEventListener("swup:enable",T);let y=document.getElementById("back-to-top-btn"),v=document.getElementById("toc-wrapper"),E=document.getElementById("navbar-wrapper");function N(t,o){let e;return function(){const n=arguments,a=this;e||(t.apply(a,n),e=!0,setTimeout(()=>e=!1,o))}}function O(){const t=document.documentElement.scrollTop,o=window.innerHeight*(L/100);requestAnimationFrame(()=>{if(y&&(t>o?y.classList.remove("hide"):y.classList.add("hide")),I&&v&&(t>o?v.classList.remove("toc-hide"):v.classList.add("toc-hide")),I&&E){const n=document.body.classList.contains("lg:is-home")&&window.innerWidth>=1024?A:L,a=window.innerHeight*(n/100)-88;t>=a?E.classList.add("navbar-hidden"):E.classList.remove("navbar-hidden")}})}window.onscroll=N(O,16);window.onresize=()=>{let t=Math.floor(window.innerHeight*(S/100));t=t-t%4,document.documentElement.style.setProperty("--banner-height-extend",`${t}px`)};const B=initLanguageSettings();document.documentElement.lang=B;window.dispatchEvent(new CustomEvent("language-initialized",{detail:{lang:B}}));M();document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{x()}):x();
